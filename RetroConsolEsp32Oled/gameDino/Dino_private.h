#ifndef DINO_PRIVATE_LIB_H
#define DINO_PRIVATE_LIB_H

  enum birdState { BirdUp, BirdDown, BirdFall };
  #define OBST_NARROW false
  #define OBST_WIDE true

  struct birdStr {
    int16_t x;
    int8_t y;
    bool colission = false;
    birdState state = BirdUp;
  };

  struct obstStr {
    int16_t x;
    bool type = OBST_NARROW;
  };

  struct obstTypeStr {
    uint8_t xColisionRange;
    uint8_t yColisionRange;
    uint8_t width;
    uint8_t height;
  };

  const obstTypeStr ObstParams[2]= {
    {4, 14, 22, 23}, // OBST_NARROW
    {12, 8, 22, 23}  // OBST_WIDE
  };

  struct SpriteSetStr {
    const unsigned char* Jumper1;
    const unsigned char* Jumper2;
    const unsigned char* Jumper3;
    const unsigned char* ObstHigh;
    const unsigned char* ObstWide;
    const unsigned char* Bird1;
    const unsigned char* Bird2;
    const unsigned char* Bird3;
    const char* collisionText;
  };

  extern SpriteSetStr Skins[2];

  struct GameConstStr {
    uint8_t first_obst_x = 100;
    uint8_t new_obst_x_init = 130;
    uint8_t min_obst_dist = 10;
    uint8_t baselineY = 60;
    uint8_t maxspeed = 20;
    uint8_t obst_y = 37;
    int16_t jumper_foodInit = 8;
    uint8_t jumper_baseX = 10;
    uint8_t jumper_baseY = 34;
    uint8_t jumper_xColRange = 6;
    uint8_t jumper_width = 25;
    uint8_t jumper_height = 26;
    uint8_t jumper_jumpHeight = 28;
    uint8_t Bird_width = 16;
    uint8_t Bird_height = 10;
    uint8_t Bird_initY = 12;
  };

  struct jumpStr {
    int16_t  	y;
    bool      state = true;
    int16_t 	food;
    uint8_t 	jump; // 0 - not jumping, 1 - going up, 2 - going down
    uint8_t   jumpType = 1; // 2 - long jump, 1 - high jump
    uint8_t  	jumpHangTime;
  };

  struct dGameStr {
    bool    isRect = false;
    bool    soundDone  = false;
    bool    pause = false;
    uint8_t speed;
    uint8_t sessionScore;
    uint8_t spriteSetIndex = 0;
  };

namespace DinoGame {
  void Game_Dino();
  bool ItsCollisionWithTree(dGameStr& DinoGame, jumpStr& Dino, obstStr& tree, const GameConstStr& GameConst);
  void CheckButtons(dGameStr& DinoGame, jumpStr& Dino);
  void CalcBirdXYpos(dGameStr& DinoGame, birdStr& Bird, const GameConstStr& GameConst);
  void CalcGameSpeed(dGameStr& DinoGame, const GameConstStr& GameConst);
  void CalcTreesXpos (dGameStr& DinoGame, obstStr& Obst1, obstStr& Obst2, const GameConstStr& GameConst);
  void CheckIfBirdColision(dGameStr& DinoGame, jumpStr& Dino, birdStr& Bird, const GameConstStr& GameConst);
  void DisplayGameSummary(dGameStr& DinoGame, jumpStr& Dino);
  void DisplayOutOfFood();
  void DisplayScore(dGameStr& DinoGame, jumpStr& Dino);
  void WelcomeScreen();
  void DisplayFirstFrame(dGameStr& DinoGame, jumpStr& Dino, obstStr& Obst1, obstStr& Obst2, const GameConstStr& GameConst);
  void GameOverTreeColisionDetected(dGameStr& DinoGame,jumpStr& Dino, const GameConstStr& GameConst);
  void PauseGame(dGameStr& DinoGame);
  void InitParams(dGameStr& DinoGame, jumpStr& Dino, birdStr& Bird, obstStr& Obst1, obstStr& Obst2, const GameConstStr& GameConst);
  void HandleDinoJump(dGameStr& DinoGame, jumpStr& Dino, const GameConstStr& GameConst);
  void JumpSound(dGameStr& DinoGame);
  void MoveAndDisplayBird(dGameStr& DinoGame, birdStr& Bird, const GameConstStr& GameConst);
  void MoveAndDisplayDino(dGameStr& DinoGame, jumpStr& Dino, const GameConstStr& GameConst);
  void MoveAndDisplayTree(dGameStr& DinoGame, obstStr& tree, const GameConstStr& GameConst);
  void GameLoop (dGameStr& DinoGame, jumpStr& Dino, birdStr& Bird, obstStr& Obst1, obstStr& Obst2, const GameConstStr& GameConst);
  void ShowScore(dGameStr& DinoGame);
  void TurboSpeed(dGameStr& DinoGame, bool direction, int16_t* sprite);
  void UpdateGameFrame(dGameStr& DinoGame, jumpStr& Dino, birdStr& Bird, obstStr& Obst1, obstStr& Obst2, const GameConstStr& GameConst);
}

  extern const GameInfo GameInfo_Dino;

  //
  static const unsigned char PROGMEM Bird1[] = {
  0x01, 0x00, 0x01, 0x80, 0x01, 0xc0, 0x01, 0xc0, 0x19, 0xe0, 0x3d, 0xf0, 0x6d, 0xf8, 0xff, 0xff, 
  0x07, 0xfe, 0x01, 0xf8
  };
  static const unsigned char PROGMEM Bird2[] = {
  0x18, 0x00, 0x3c, 0x00, 0x6c, 0x01, 0xff, 0xff, 0x07, 0xfe, 0x00, 0xfc, 0x00, 0x7c, 0x00, 0x3c, 
  0x00, 0x1e, 0x00, 0x0c
  };
  // 
  static const unsigned char PROGMEM Bird3[] = {
  0x00, 0x00, 0x01, 0x00, 0x09, 0x80, 0x19, 0xc0, 0x1d, 0xc0, 0x1f, 0xc0, 0x0f, 0xc0, 0x07, 0xc0, 
  0x03, 0xc0, 0x01, 0x80, 0x07, 0x80, 0x0d, 0x00, 0x0f, 0x80, 0x07, 0xc0, 0x03, 0x40, 0x01, 0x40
  };
  static const unsigned char PROGMEM dino1[]={
  // 25x26px
  0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xfe, 0x00, 0x00, 0x06, 0xff, 0x00, 0x00, 0x0e, 0xff, 0x00, 
  0x00, 0x0f, 0xff, 0x00, 0x00, 0x0f, 0xff, 0x00, 0x00, 0x0f, 0xff, 0x00, 0x00, 0x0f, 0xc0, 0x00, 
  0x00, 0x0f, 0xfc, 0x00, 0x40, 0x0f, 0xc0, 0x00, 0x40, 0x1f, 0x80, 0x00, 0x40, 0x7f, 0x80, 0x00, 
  0x60, 0xff, 0xe0, 0x00, 0x71, 0xff, 0xa0, 0x00, 0x7f, 0xff, 0x80, 0x00, 0x7f, 0xff, 0x80, 0x00, 
  0x7f, 0xff, 0x80, 0x00, 0x3f, 0xff, 0x00, 0x00, 0x1f, 0xff, 0x00, 0x00, 0x0f, 0xfe, 0x00, 0x00, 
  0x03, 0xfc, 0x00, 0x00, 0x01, 0xdc, 0x00, 0x00, 0x01, 0x8c, 0x00, 0x00, 0x03, 0x8c, 0x00, 0x00, 
  0x00, 0x0c, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00
  };
  static const unsigned char PROGMEM dino2[]= {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xfe, 0x00, 0x00, 0x06, 0xff, 0x00, 0x00, 0x0e, 0xff, 0x00, 
    0x00, 0x0f, 0xff, 0x00, 0x00, 0x0f, 0xff, 0x00, 0x00, 0x0f, 0xff, 0x00, 0x00, 0x0f, 0xc0, 0x00, 
    0x00, 0x0f, 0xfc, 0x00, 0x80, 0x0f, 0xc0, 0x00, 0x80, 0x1f, 0x80, 0x00, 0xc0, 0x7f, 0xa0, 0x00, 
    0xe0, 0xff, 0xe0, 0x00, 0x71, 0xff, 0xc0, 0x00, 0x7f, 0xff, 0x80, 0x00, 0x7f, 0xff, 0x80, 0x00, 
    0x7f, 0xff, 0x80, 0x00, 0x3f, 0xff, 0x00, 0x00, 0x1f, 0xff, 0x00, 0x00, 0x0f, 0xfe, 0x00, 0x00, 
    0x03, 0xfc, 0x00, 0x00, 0x01, 0xdc, 0x00, 0x00, 0x01, 0x8e, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 
    0x01, 0x80, 0x00, 0x00, 0x01, 0xc0, 0x00, 0x00
  };
  static const unsigned char PROGMEM dino3[]= {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xfe, 0x00, 0x00, 0x06, 0xff, 0x00, 0x00, 0x0e, 0xff, 0x00, 
    0x00, 0x0f, 0xff, 0x00, 0x00, 0x0f, 0xff, 0x00, 0x00, 0x0f, 0xff, 0x00, 0x00, 0x0f, 0xc0, 0x00, 
    0x00, 0x0f, 0xfc, 0x00, 0x00, 0x0f, 0xc0, 0x00, 0x00, 0x1f, 0x90, 0x00, 0x80, 0x7f, 0xa0, 0x00, 
    0xc0, 0xff, 0xc0, 0x00, 0x71, 0xff, 0x80, 0x00, 0x7f, 0xff, 0x80, 0x00, 0x7f, 0xff, 0x80, 0x00, 
    0x7f, 0xff, 0x80, 0x00, 0x3f, 0xff, 0x00, 0x00, 0x1f, 0xff, 0x00, 0x00, 0x0f, 0xfe, 0x00, 0x00, 
    0x03, 0xfc, 0x00, 0x00, 0x01, 0xdc, 0x00, 0x00, 0x01, 0x8c, 0x00, 0x00, 0x03, 0x18, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
  };
  static const unsigned char PROGMEM Obst1[]={
  // 'Obst1', 22x23px
	0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0xc0, 0x00, 0x01, 0x88, 0x00, 0x01, 0x9c, 0x00, 0x01, 
	0x9c, 0x00, 0x00, 0xcc, 0x00, 0x00, 0x48, 0x00, 0x00, 0xd8, 0x00, 0x00, 0xd8, 0x00, 0x00, 0xc8, 
	0x00, 0x01, 0x8c, 0x00, 0x01, 0x9c, 0x00, 0x00, 0xdc, 0x00, 0x00, 0x4c, 0x00, 0x01, 0x4c, 0x00, 
	0x01, 0xc8, 0x00, 0x00, 0xd8, 0x00, 0x00, 0xf8, 0x00, 0x00, 0x78, 0x00, 0x00, 0x70, 0x00, 0x00, 
	0x70, 0x00, 0x00, 0x70, 0x00
  };
  static const unsigned char PROGMEM Obst2[]={
  // 'Obst2', 22x23px
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x20, 0x08, 0x00, 0x60, 0x08, 0x91, 0x20, 0x0c, 0xb3, 0x60, 0x0d, 0xb3, 0x40, 0x0d, 0xb3, 0x40, 
	0x0d, 0xb3, 0x60, 0x0d, 0xb7, 0x30, 0x0f, 0xbe, 0x30, 0x07, 0x3e, 0x60, 0x07, 0x1c, 0x40, 0x02, 
	0x0c, 0x40, 0x07, 0x0c, 0x40
};
static const unsigned char PROGMEM cat1[]={
	// 'cat', 25x26px
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x08, 0x00, 
	0x00, 0x05, 0x14, 0x00, 0x00, 0x04, 0xe2, 0x00, 0x00, 0x08, 0x02, 0x00, 0x00, 0x08, 0xda, 0x00, 
	0x00, 0x08, 0xda, 0x00, 0x00, 0x08, 0x02, 0x00, 0x00, 0x04, 0x22, 0x00, 0x00, 0x02, 0x04, 0x00, 
	0x80, 0xf9, 0x08, 0x00, 0x41, 0x07, 0xf0, 0x00, 0x42, 0x00, 0x40, 0x00, 0x24, 0x00, 0x40, 0x00, 
	0x38, 0x42, 0x20, 0x00, 0x10, 0xf1, 0x20, 0x00, 0x11, 0x0f, 0x90, 0x00, 0x12, 0x00, 0x50, 0x00, 
	0x0a, 0x00, 0x30, 0x00, 0x0f, 0x00, 0x18, 0x00
};
static const unsigned char PROGMEM cat2[]= {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x08, 0x00, 
	0x00, 0x05, 0x14, 0x00, 0x00, 0x04, 0xe2, 0x00, 0x00, 0x08, 0x02, 0x00, 0x00, 0x08, 0x6e, 0x00, 
	0x00, 0x08, 0x6e, 0x00, 0x00, 0x08, 0x02, 0x00, 0x00, 0x04, 0x12, 0x00, 0x00, 0x02, 0x04, 0x00, 
	0x18, 0xf9, 0x08, 0x00, 0x21, 0x07, 0xf0, 0x00, 0x42, 0x00, 0x20, 0x00, 0x44, 0x00, 0x20, 0x00, 
	0x38, 0x00, 0x20, 0x00, 0x10, 0x31, 0x20, 0x00, 0x08, 0x4f, 0x40, 0x00, 0x04, 0x81, 0x40, 0x00, 
	0x02, 0x82, 0x80, 0x00, 0x01, 0xc3, 0x80, 0x00
};
static const unsigned char PROGMEM cat3[]= {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x01, 0x10, 0x00, 0x00, 0x02, 0xe8, 0x00, 0x00, 0x02, 0x04, 0x00, 0x00, 0x04, 0xdc, 0x00, 
	0x00, 0x04, 0x04, 0x00, 0x00, 0x04, 0x24, 0x00, 0x00, 0x02, 0x08, 0x00, 0x00, 0x0f, 0x10, 0x00, 
	0x00, 0x31, 0xfc, 0x00, 0x00, 0x40, 0x02, 0x00, 0x00, 0x80, 0x3c, 0x00, 0x01, 0x04, 0xc0, 0x00, 
	0x02, 0x03, 0x00, 0x00, 0x04, 0x0c, 0x00, 0x00, 0x08, 0x30, 0x00, 0x00, 0x14, 0xc0, 0x00, 0x00, 
	0x29, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
const unsigned char PROGMEM murek1 []  = {
  0x00, 0x00, 0x00, 0x00, 0x70, 0x00, 0x00, 0xe8, 0x00, 0x00, 0xa8, 0x00, 0x00, 0xb8, 0x00, 0x00, 
	0xe8, 0x00, 0x00, 0xa8, 0x00, 0x00, 0xb8, 0x00, 0x00, 0xe8, 0x00, 0x00, 0xa8, 0x00, 0x00, 0xb8, 
	0x00, 0x00, 0xe8, 0x00, 0x00, 0xa8, 0x00, 0x00, 0xb8, 0x00, 0x00, 0xe8, 0x00, 0x00, 0xa8, 0x00, 
	0x00, 0xb8, 0x00, 0x00, 0xe8, 0x00, 0x00, 0xa8, 0x00, 0x00, 0xb8, 0x00, 0x00, 0xe8, 0x00, 0x00, 
	0xa8, 0x00, 0x00, 0xb8, 0x00
};
const unsigned char PROGMEM murek2 []  = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xff, 0x00, 0x09, 0x24, 0x80, 
	0x1f, 0xff, 0xc0, 0x14, 0x92, 0x40, 0x1f, 0xff, 0xc0, 0x12, 0x49, 0x40, 0x1f, 0xff, 0xc0, 0x14, 
	0x92, 0x40, 0x1f, 0xff, 0xc0
};
const unsigned char PROGMEM bird1 []  = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x04, 0x48, 0x0e, 0x90, 0x1f, 0xe0, 0x00, 0x10, 
	0x00, 0x00, 0x00, 0x00
};
const unsigned char PROGMEM bird2 []  = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x78, 0x0a, 0xfe, 0x1f, 0xe0, 0x00, 0x10, 
	0x00, 0x00, 0x00, 0x00
};
const unsigned char PROGMEM bird3 []  = {
	0x00, 0x20, 0x00, 0x68, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xe0, 0x00, 0x40, 0x03, 0xc0, 0x02, 0xc0, 
	0x03, 0x80, 0x00, 0x80
};

#endif
